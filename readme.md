# End to End Autonomous Driving Base Framework

## Description

This project provides a fundamental framework for end-to-end autonomous driving. It is an ideal starting point for those looking to develop a more sophisticated end-to-end autonomous driving algorithm. With a clear logic structure, the system utilizes two parallel models that process images from the vehicle's front-facing camera to predict steering angles and brake/throttle values. The models synthesize these predictions to output final control parameters. By invoking `network.synthetical_model`, users can input images (obtained via `cv2.imread`) and receive output control parameters (brake, throttle, steering_angle).

![system_architecture](figures%2FFigure2.drawio.png)

The steering angle prediction employs a Resnet50 as its backbone, modified to output channels that train for steering angle regression prediction.
![training_loss](figures%2F128%200.0005%2085epoch.png)
The trained model weights are stored in the `train` folder and are automatically loaded when used. The prediction for throttle and brake is based on the detection of vehicles and traffic lights using bounding boxes generated by a pretrained YOLOv8 model.
![yolov8.jpg](figures%2Fyolov8.jpg)
## Installation

This project is built on PyTorch. To install the required libraries, refer to the `requirements.txt` file.

## Models

- **Steering Angle Prediction**: Utilizes Resnet50 with modified output channels for regression prediction of steering angles. Trained model weights are located in the `train` folder.
- **Throttle and Brake Prediction**: Based on vehicle and traffic light detection using YOLOv8's pretrained model to predict throttle and brake values.

## How to Use

To use the framework, simply call `network.synthetical_model` with an image input (obtained via `cv2.imread`) to receive the control parameters.
You can find relevant demo in the file, it will show you the using method.

## Contribution Guidelines

If you wish to use this project, please credit the source.

## Maintainer

- Shihong Zhang

## Additional Resources

For more detailed information, please refer to the `Team07_Simulation_Based_Autonomous_Driving_In_Crowded_City_Final_Report.pdf` document located in the root directory.


